# HearthStone Monitor

## 目标

* 能够模拟卡牌的行为
* 增加想要的随机环境效果和 BAN 卡牌的效果

## 原理

* 卡牌没有写权限，但是有读权限，只有系统才具有写权限，所以修改的任务通过 event 发送给系统

* 卡牌是空白的容器，平台，启动后动态授予其功能，就像淘宝和卖家的关系，比如杰弗里斯的战吼可以被沙德沃克再次使用

* 系统需要维护的：
** 卡牌和事件队列
** 根据事件遍历卡牌队列，然后执行匹配的函数即可
** 提供精简的接口给卡牌去实现自己的功能

* 设定的时候用 FUNC ID 表示
* 实际卡牌结构体仅仅是容器，属性可以自由添加和删除

* 属性是可以被赋予的，所以， card 结构体设计的时候要能被赋予，而且像亡语，可以赋予多次，还有沉默后赋予要考虑进去
** 属性更像一个链路，可以添加删除
* 属性变化前，属性变化，属性变化后，而属性是多样化的
* 每一个事件是原子操作，必须处理完成后才能处理下一个
* 所有的同一个对象，只是动态赋予的属性不同
* 所有对象的属性都类似于上升沿下降沿，所有的操作都是对边沿信号变化的响应 OnAttrActionPre/Post
* 每一个对象类似于 IP 保有各自的属性，互相影响属性
* 所有的卡牌放在一个列表中
* 卡牌属性，每一个属性对应一种行为和触发条件
* 可以用实物模拟

## 信号与注册：操作与时机

注意，部分操作并不是顺序的，根据用户来。

全局信号（属性）：

* 选牌：开始
* 奇偶，牌库初始化完成
* 回合开始：回合
* 水晶增加前后：水晶
* 抽牌（前/后）：牌的位置
* 使用一张牌（前/后）：牌的位置
* 攻击前后：血量
* 回合结束
* 使用技能前后：技能

## 例子

